(function(){window.ImageLazyLoad=(function(){a.prototype.version="1.0.1";a.prototype.lastTopPosition=0;a.prototype.options={range:null,elements:"img",errorImage:"about:blank",container:"body",mode:"vertical",realSrcAttribute:"data-src",useFade:true,afterImageLoaded:null,afterImageLoadError:null,defaultScrollTriggerDelay:150,loadingAtTopToEnd:true,autoUpdateOnWindowResize:false};
a.prototype.setOptions=function(b){var d,c;if(b==null){return;}for(d in b){if(b.hasOwnProperty(d)){this.options[d]=b[d];}}if(typeof this.options.errorImage==="string"){c=this.options.errorImage;
this.options.errorImage=new Image();this.options.errorImage.src=c;if(this.options.container===window){return this.options.container="body";}}};function a(b){var c=this;
this.setOptions(b);this.$container=$(this.options.container);this.$elements=this.$container.find(this.options.elements);if(this.options.useFade){this.fadeAll();
}this.axis=this.options.mode==="vertical"?"top":"left";this.viewPort=this.options.container==="body"?$(window):this.$container;this.viewPortSize=this.axis==="top"?this.viewPort.height():this.viewPort.width();
if(this.options.range==null){this.options.range=this.viewPortSize;}this.refreshLoader();this.startListenOnScroll();if(this.options.autoUpdateOnWindowResize){$(window).resize(function(){return c.refreshLoader();
});}}a.prototype.fadeAll=function(){return this.$elements.each(function(b,c){return $(c).css("opacity",0);});};a.prototype.startListenOnScroll=function(){var b=this;
this.timer;return this.viewPort.on("scroll.ImageLazyLoad",function(c){clearTimeout(b.timer);return b.timer=setTimeout(function(){return b.onScroll(c,b);
},b.options.defaultScrollTriggerDelay);});};a.prototype.refreshLoader=function(){return this.onScroll(null,this);};a.prototype.refreshElements=function(b){var c=this;
return this.$elements=this.$elements.map(function(g,h){var f,d,e;f=$(h);d=f.position()[c.axis];e=false;if(c.options.loadingAtTopToEnd){e=d<b+c.viewPortSize+c.options.range;
}else{e=(b-c.options.range<d&&d<b+c.viewPortSize+c.options.range);}if(e){c.loadImage(f);return null;}else{return h;}});};a.prototype.loadImage=function(c){var b,d=this;
b=new Image();b.onload=function(){if(typeof d.options.afterImageLoaded==="function"){return d.options.afterImageLoaded(c,b.src);}else{c.attr("src",b.src);
if(d.options.useFade){return c.css("opacity",1);}}};b.onerror=function(){if(typeof d.options.afterImageLoadError==="function"){return d.options.afterImageLoadError(c,d.options.errorImage.src);
}else{c.attr("src",d.options.errorImage.src);if(d.options.useFade){return c.css("opacity",1);}}};return b.src=c.attr(this.options.realSrcAttribute);};a.prototype.onScroll=function(c,b){var d;
d=b.axis==="top"?b.viewPort.scrollTop():b.viewPort.scrollLeft();if(b.canLoading(d)){b.refreshElements(d);if(b.$elements.length===0){return b.unbindEvents();
}}};a.prototype.canLoading=function(b){if(!this.loadingAtTopToEnd){return true;}if(b>this.lastTopPosition){this.lastTopPosition=b;return true;}else{return false;
}};a.prototype.unbindEvents=function(){return this.viewPort.off(".ImageLazyLoad");};return a;})();}).call(this);