(function(){var a=function(b,c){return function(){return b.apply(c,arguments);};};window.ImageLazyLoad=(function(){b.prototype.version="1.0.1";b.prototype.lastTopPosition=0;
b.prototype.options={range:null,elements:"img",errorImage:"about:blank",container:"body",mode:"vertical",realSrcAttribute:"data-src",useFade:true,afterImageLoaded:null,afterImageLoadError:null,defaultScrollTriggerDelay:150,loadingAtTopToEnd:true,autoUpdateOnWindowResize:false};
b.prototype.setOptions=function(c){var e,d;if(c==null){return;}for(e in c){if(c.hasOwnProperty(e)){this.options[e]=c[e];}}if(typeof this.options.errorImage==="string"){d=this.options.errorImage;
this.options.errorImage=new Image();this.options.errorImage.src=d;if(this.options.container===window){return this.options.container="body";}}};function b(c){this.loadAll=a(this.loadAll,this);
var d=this;this.setOptions(c);this.$container=$(this.options.container);this.$elements=this.$container.find(this.options.elements);if(this.options.useFade){this.fadeAll();
}this.axis=this.options.mode==="vertical"?"top":"left";this.viewPort=this.options.container==="body"?$(window):this.$container;this.viewPortSize=this.axis==="top"?this.viewPort.height():this.viewPort.width();
if(this.options.range==null){this.options.range=this.viewPortSize;}this.refreshLoader();this.startListenOnScroll();if(this.options.autoUpdateOnWindowResize){$(window).resize(function(){return d.refreshLoader();
});}}b.prototype.fadeAll=function(){return this.$elements.each(function(c,d){return $(d).css("opacity",0);});};b.prototype.loadAll=function(){var c=this;
this.$elements.each(function(d,e){return c.loadImage($(e));});this.$elements=[];return this.unbindEvents();};b.prototype.startListenOnScroll=function(){var c=this;
this.timer;return this.viewPort.on("scroll.ImageLazyLoad",function(d){clearTimeout(c.timer);return c.timer=setTimeout(function(){return c.onScroll(d,c);
},c.options.defaultScrollTriggerDelay);});};b.prototype.refreshLoader=function(){return this.onScroll(null,this);};b.prototype.refreshElements=function(c){var d=this;
return this.$elements=this.$elements.map(function(h,j){var g,e,f;g=$(j);e=g.position()[d.axis];f=false;if(d.options.loadingAtTopToEnd){f=e<c+d.viewPortSize+d.options.range;
}else{f=(c-d.options.range<e&&e<c+d.viewPortSize+d.options.range);}if(f){d.loadImage(g);return null;}else{return j;}});};b.prototype.loadImage=function(d){var c,e=this;
c=new Image();c.onload=function(){if(typeof e.options.afterImageLoaded==="function"){return e.options.afterImageLoaded(d,c.src);}else{d.attr("src",c.src);
if(e.options.useFade){return d.css("opacity",1);}}};c.onerror=function(){if(typeof e.options.afterImageLoadError==="function"){return e.options.afterImageLoadError(d,e.options.errorImage.src);
}else{d.attr("src",e.options.errorImage.src);if(e.options.useFade){return d.css("opacity",1);}}};return c.src=d.attr(this.options.realSrcAttribute);};b.prototype.onScroll=function(d,c){var f;
f=c.axis==="top"?c.viewPort.scrollTop():c.viewPort.scrollLeft();if(c.canLoading(f)){c.refreshElements(f);if(c.$elements.length===0){return c.unbindEvents();
}}};b.prototype.canLoading=function(c){if(!this.options.loadingAtTopToEnd){return true;}if(c>this.lastTopPosition){this.lastTopPosition=c;return true;}else{return false;
}};b.prototype.unbindEvents=function(){return this.viewPort.off(".ImageLazyLoad");};b.prototype.bindEvents=function(){return this.startListenOnScroll();
};return b;})();}).call(this);